- hosts: localhost
  become: true
  gather_facts: false
  vars:
    ansible_become_password: "{{ localhost_become_password }}"
    venv_path: /opt/netapp_ansible
  tasks:
    - name: Install Python 3
      package:
        name: python3

    - name: Install virtualenv
      pip:
        name: virtualenv
        executable: pip3

    - name: Make venv Directory
      shell: |
        virtualenv {{ venv_path }}
      args:
        creates: "{{ venv_path }}"

    - name: Install ansible
      pip:
        virtualenv: "{{ venv_path }}"
        name: ansible
        version: "{{ ansible_version }}"
        umask: "0022"
